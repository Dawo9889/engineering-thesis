vrrp_script chk_haproxy {
  script "/usr/bin/pgrep haproxy"
  interval 2
  timeout 2
  fall 2
  rise 2
}

vrrp_instance VI_1 {
  state {{ keepalived_state | default('BACKUP') }}
  interface {{ keepalived_interface }}
  virtual_router_id {{ virtual_router_id }}
  priority {{ keepalived_priority | default(100) }}
  advert_int 1
  authentication {
    auth_type PASS
    auth_pass {{ keepalived_auth_pass }}
  }
  virtual_ipaddress {
    {{ virtual_ip }}
  }
  track_script {
    chk_haproxy
  }
}
